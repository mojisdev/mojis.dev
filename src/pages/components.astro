---
import PageLayout from "../layouts/page-layout.astro";

export async function getStaticPaths() {
  const res = await fetch("https://raw.githubusercontent.com/mojisdev/emoji-data/refs/heads/main/emojis.lock");

  if (!res.ok) {
    throw new Error("failed to fetch emoji versions");
  }

  const json = await res.json();

  const latestVersion = json.latestVersion;

  const componentsRes = await fetch("https://raw.githubusercontent.com/mojisdev/emoji-data/refs/heads/main/unicode/" + latestVersion + "/components.json");

  if (!componentsRes.ok) {
    throw new Error("failed to fetch components for version " + version);
  }

  const components = await componentsRes.json();

  return [
    {
      props: {
        version: latestVersion,
        components,
      },
    }
  ];
}

const { components, version } = Astro.props;
---

<PageLayout>
  <h1>Version: {version}</h1>

  <h2>Components</h2>
  <ul>
    {JSON.stringify(components)}
  </ul>
</PageLayout>
